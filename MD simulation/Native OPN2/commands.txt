# The system was created without retinal in CHARMM-GUI. 
# Manual deletion of hydrogen atoms on residual 296K and retinal, in order to prepare for Schiff base linkage. 
# Copy the retinal atoms into relevant files. 

gmx make_ndx -f solv_ions.gro -o index.ndx
> combine groups "SOLU" and "RET" to form the new group "SOLU"

gmx grompp -f cis6.0_minimization.mdp  -o cis6.0.tpr -p topol_cis.top -n index.ndx -c starting_configuration.gro   -r starting_configuration.gro
gmx mdrun -deffnm cis6.0 -v
gmx grompp -f cis6.1_equilibration.mdp -o cis6.1.tpr -p topol_cis.top -n index.ndx -c cis6.0.gro -r cis6.0.gro
gmx mdrun -deffnm cis6.1 -v
gmx grompp -f cis6.2_equilibration.mdp -o cis6.2.tpr -p topol_cis.top -n index.ndx -c cis6.1.gro -r cis6.1.gro -t cis6.1.cpt
gmx mdrun -deffnm cis6.2 -v
gmx grompp -f cis6.3_equilibration.mdp -o cis6.3.tpr -p topol_cis.top -n index.ndx -c cis6.2.gro -r cis6.2.gro -t cis6.2.cpt
gmx mdrun -deffnm cis6.3 -v
gmx grompp -f cis6.4_equilibration.mdp -o cis6.4.tpr -p topol_cis.top -n index.ndx -c cis6.3.gro -r cis6.3.gro -t cis6.3.cpt
gmx mdrun -deffnm cis6.4 -v
gmx grompp -f cis6.5_equilibration.mdp -o cis6.5.tpr -p topol_cis.top -n index.ndx -c cis6.4.gro -r cis6.4.gro -t cis6.4.cpt
gmx mdrun -deffnm cis6.5 -v
gmx grompp -f cis6.6_equilibration.mdp -o cis6.6.tpr -p topol_cis.top -n index.ndx -c cis6.5.gro -r cis6.5.gro -t cis6.5.cpt
gmx mdrun -deffnm cis6.6 -v
gmx grompp -f cis7_production.mdp      -o cis7.tpr   -p topol_cis.top -n index.ndx -c cis6.6.gro -r cis6.6.gro -t cis6.6.cpt
gmx mdrun -deffnm cis7 -v

# Manual isomerization of 11-cis-retinal to all-trans-retinal. 

gmx grompp -f trans6.0_minimization.mdp  -o trans6.0.tpr -p topol_trans.top -n index.ndx -c cis_to_trans.gro   -r cis_to_trans.gro
gmx mdrun -deffnm trans6.0 -v
gmx grompp -f trans6.1_equilibration.mdp -o trans6.1.tpr -p topol_trans.top -n index.ndx -c trans6.0.gro -r trans6.0.gro
gmx mdrun -deffnm trans6.1 -v
gmx grompp -f trans6.2_equilibration.mdp -o trans6.2.tpr -p topol_trans.top -n index.ndx -c trans6.1.gro -r trans6.1.gro -t trans6.1.cpt
gmx mdrun -deffnm trans6.2 -v
gmx grompp -f trans6.3_equilibration.mdp -o trans6.3.tpr -p topol_trans.top -n index.ndx -c trans6.2.gro -r trans6.2.gro -t trans6.2.cpt
gmx mdrun -deffnm trans6.3 -v
gmx grompp -f trans6.4_equilibration.mdp -o trans6.4.tpr -p topol_trans.top -n index.ndx -c trans6.3.gro -r trans6.3.gro -t trans6.3.cpt
gmx mdrun -deffnm trans6.4 -v
gmx grompp -f trans6.5_equilibration.mdp -o trans6.5.tpr -p topol_trans.top -n index.ndx -c trans6.4.gro -r trans6.4.gro -t trans6.4.cpt
gmx mdrun -deffnm trans6.5 -v
gmx grompp -f trans6.6_equilibration.mdp -o trans6.6.tpr -p topol_trans.top -n index.ndx -c trans6.5.gro -r trans6.5.gro -t trans6.5.cpt
gmx mdrun -deffnm trans6.6 -v
gmx grompp -f trans7_production.mdp      -o trans7.tpr   -p topol_trans.top -n index.ndx -c trans6.6.gro -r trans6.6.gro -t trans6.6.cpt
gmx mdrun -deffnm trans7 -v